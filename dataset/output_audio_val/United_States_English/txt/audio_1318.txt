This is a problem closely related to the longest common subsequence problem.